services:
  db-master:
    image: postgres-master:15
    container_name: postgres_db_master
    restart: unless-stopped
    tty: true
    environment:
      POSTGRES_USER: ${DB_MASTER_USER}
      POSTGRES_PASSWORD: ${DB_MASTER_PASS}
      POSTGRES_DB: ${DB_MASTER_NAME}
    networks:
      - mns-sis-master-system-network
  db-ppdb:
    image: postgres-ppdb:15
    container_name: postgres_db_ppdb
    restart: unless-stopped
    tty: true
    environment:
      POSTGRES_USER: ${DB_PPDB_USER}
      POSTGRES_PASSWORD: ${DB_PPDB_PASS}
      POSTGRES_DB: ${DB_PPDB_NAME}
    networks:
      - mns-sis-master-system-network
  service-mns-master-system:
    image: service-mns-master-system
    volumes:
      - /home/docker/uploads:/app/uploads:rw
    container_name: service_mns_master_system-1.0.0-snapshot
    restart: unless-stopped
    tty: true
    environment:
      DB_MASTER_USER: ${DB_MASTER_USER}
      DB_MASTER_PASS: ${DB_MASTER_PASS}
      DB_MASTER_NAME: ${DB_MASTER_NAME}
      DB_MASTER_HOST: db-master
      DB_MASTER_PORT: ${DB_MASTER_PORT}
      DB_PPDB_USER: ${DB_PPDB_USER}
      DB_PPDB_PASS: ${DB_PPDB_PASS}
      DB_PPDB_NAME: ${DB_PPDB_NAME}
      DB_PPDB_HOST: db-ppdb
      DB_PPDB_PORT: ${DB_PPDB_PORT}
      DB_BILL_USER: ${DB_BILL_USER}
      DB_BILL_PASS: ${DB_BILL_PASS}
      DB_BILL_NAME: ${DB_BILL_NAME}
      DB_BILL_HOST: ${DB_BILL_HOST}
      DB_BILL_PORT: ${DB_BILL_PORT}
    ports:
      - "${APP_PORT}:8080"
    networks:
      - mns-sis-master-system-network

networks:
  mns-sis-master-system-network:
    external: true